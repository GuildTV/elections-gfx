<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="public/css/app.css" />
  </head>

  <body>
    <div class="lt-wrapper">
      <div style="background:url('public/img/template/name-lt.png') no-repeat center center fixed; background-size: cover; position: absolute; float: left; top: 0px; left: 0px; width: 1920px; height: 1080px;"></div>
      <div class="lower-third2">    
        <div class="content">
          <div class="inner">
            <h1></h1>
            <h2></h2>
          </div>
        </div>
      </div>
    </div>

    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" class="filters hidden">
      <defs>
        <filter id="motionBlur">
          <feGaussianBlur id="svg-blur-inner" in="SourceGraphic" stdDeviation="0,10" />
        </filter>
      </defs>
    </svg>

    <!-- Scripts -->
    <script type="text/javascript" src="public/lib/gsap/TweenMax.js"></script>
    <script type="text/javascript" src="public/js/data.js"></script>
    <script type="text/javascript">

      /////// BLUR
      var filters = document.querySelector(".filters"), // the SVG that contains the filters
      defs = filters.querySelector("defs"), // the  element inside the SVG
      blur = defs.querySelector("#motionBlur"), // the blur filter
      blurFilter = blur.firstElementChild; // the feGaussianBlur primitive
      var blurStrength = 10;

      function animateBlur(tl, elm, blurData){
        blurFilter.setAttribute("stdDeviation","0,"+(blurData.myVal+0.01));  
      }

      function animate(){
        var tl = new TimelineLite();

        var dataWrapper = document.querySelector('.lt-wrapper');
        dataWrapper.classList.add('visible');

        var blurData = { myVal: blurStrength };

        //tl.to(dataWrapper, 0.32, { ease: Power1.easeOut, css: { y: 0 } })
          tl.to(blurData, 0.28, { ease: Power2.easeIn, myVal: 0, onUpdate: animateBlur, onUpdateParams: ["{self}", dataWrapper, blurData] });//, '-=0.28');
      }

      function animateOut(){
        var tl = new TimelineLite();

        var dataWrapper = document.querySelector('.lt-wrapper');
        dataWrapper.classList.remove('visible');

        var blurData = { myVal: 0 };

        //tl.to(dataWrapper, 0.32, { ease: Power1.easeIn, css: { y: 400 } })
          tl.to(blurData, 0.28, { ease: Power2.easeOut, myVal: blurStrength, onUpdate: animateBlur, onUpdateParams: ["{self}", dataWrapper, blurData] });//, '-=0.28');
      }

      function render(data){
        var outer = document.querySelector('.lower-third2');

        outer.querySelector('h1').innerText = (data.name+"").toUpperCase();
        outer.querySelector('h2').innerText = (data.role+"").toUpperCase();

        animate();
      }

      <!--
        // the out video animation should be able to deal with hiding the data, before destroying it
      -->

      function play(str){
        //update(str);
      }

      function update(str){
        var data = xmlToObject(str);

        render(data);
      }
      
      // CALL 1-1 STOP
      function stop(str) {
        animateOut();
      }
      // CALL 1-1 REMOVE
      function remove() {
        document.querySelector('body').innerHTML = "";
      }

      //temporary to fake data (for testing in browser)
      function fake(){
        update("<templateData><componentData id=\"name\"><data id=\"text\" value=\"simon harwood\" /></componentData><componentData id=\"role\"><data id=\"text\" value=\"bbc, director of strategic governance\" /></componentData></templateData>");
      }

      // setTimeout(fake, 1000);
      // setTimeout(stop, 10000);

    </script>

  </body>
</html>